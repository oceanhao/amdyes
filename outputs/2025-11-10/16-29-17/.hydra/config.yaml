data:
  custom_cls:
    path: /remote-home/haohh/_cvpr2025/VG-LLM/src/qwen_vl/data/online_rl_dataset.py
    name: QwenVLRLOnlineDataset
  dataset_use: spar_234k,llava_hound_64k
  stage: cold_start
  prompt_key: prompt
  image_key: image
  max_prompt_length: 20480
  max_response_length: 512
  train_batch_size: 128
  train_max_samples: 32
  val_max_samples: 32
custom_reward_function:
  path: verl/verl/utils/reward_score/spatial_sense_reward.py
  name: compute_score
  reward_kwargs:
    alpha: 1.0
    beta: 0.2
    lambda_coef: 0.5
actor_rollout_ref:
  model:
    path: /remote-home/haohh/_cvpr2025/VG-LLM/ckpt_saves/mhan/flex-percept-init-3e
    trust_remote_code: true
    external_lib: qwen_vl.model.modeling_qwen2_5_vl
  actor:
    strategy: fsdp
    ppo_mini_batch_size: 64
    ppo_micro_batch_size_per_gpu: 4
    use_kl_loss: true
    kl_loss_coef: 0.001
    ppo_epochs: 1
  ref:
    log_prob_micro_batch_size_per_gpu: 8
  rollout:
    name: vllm
    temperature: 1.0
    top_k: -1
    top_p: 1.0
    dtype: bfloat16
    gpu_memory_utilization: 0.85
    'n': 4
    ignore_eos: false
    free_cache_engine: true
    enforce_eager: true
    tensor_model_parallel_size: 1
    max_num_seqs: 1024
    engine_kwargs:
      vllm:
        max_num_seqs: 1024
        max_num_batched_tokens: 8192
        enforce_eager: true
critic:
  model:
    path: /remote-home/haohh/_cvpr2025/VG-LLM/ckpt_saves/mhan/flex-percept-init-3e
  optim:
    lr: 1.0e-05
  ppo_micro_batch_size_per_gpu: 4
algorithm:
  adv_estimator: grpo
  gamma: 1.0
  lam: 1.0
  use_kl_in_reward: false
trainer:
  balance_batch: true
  total_epochs: 30
  total_training_steps: null
  project_name: verl_spatial
  experiment_name: gsm8k
  logger:
  - console
  - wandb
  log_val_generations: 0
  rollout_data_dir: null
  validation_data_dir: null
  nnodes: 1
  n_gpus_per_node: 1
  save_freq: -1
  esi_redundant_time: 0
  resume_mode: auto
  resume_from_path: null
  val_before_train: true
  val_only: false
  test_freq: -1
  critic_warmup: 0
  default_hdfs_dir: null
  del_local_ckpt_after_load: false
  default_local_dir: checkpoints/${trainer.project_name}/${trainer.experiment_name}
  max_actor_ckpt_to_keep: null
  max_critic_ckpt_to_keep: null
  ray_wait_register_center_timeout: 300
  device: cuda
  use_legacy_worker_impl: auto
ray_kwargs:
  ray_init:
    num_cpus: null
  timeline_json_file: null
